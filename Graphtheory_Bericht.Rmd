---
title: "Graphtheory"
author: "Maximilian Feussner, Paul Kluge, Tobias Meissner"
date: "1/22/2021"
output:
  html_document:
    number_sections: no
    toc: yes
    toc_depth: 4
    toc_float: yes
    fig_caption: yes
  pdf_document:
    toc: yes
    toc_depth: '4'
    fig_caption: yes
---
<style>
body {
text-align: justify}
p.caption {
  font-size: 0.9em;
}
h1.title {
  font-size: 30px;
}
h1 { /* Header 1 */
  font-size: 24px;
}
h2 { /* Header 2 */
    font-size: 20px;
}
h3 { /* Header 3 */
    font-size: 18px;
</style>

\newcommand{\floor}[1]{\lfloor #1 \rfloor}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

```{r environment, echo=FALSE,message=FALSE}
# Load neccesary librarys
library(ggplot2)
library(plotly)
library(tidyverse)
library(rstudioapi)
library(knitr)
library(kableExtra)
library(gridExtra)

# Locate script
pathScript <- getwd()
dataDir <- paste(pathScript, "01_Data", sep="/")
```

```{r loadData, echo=FALSE, message=FALSE}
# load raw data
treeDataDf <- read.csv(paste(pathScript, 'Tree_Data_Full.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)

# Some Preparations: add a "Group"" column for easy access of data
for (i in 1:length(treeDataDf$ID)) {
  treeDataDf$Group[i] <- strsplit(as.character(treeDataDf$ID[i]), "_")[[1]][1]
}
treeDataDf$Group <- as.factor(treeDataDf$Group)

```

# Introduction

Some Informations about the projekt here would be really nice.

# Analysis

## 2.1a Fraction of Xenelogs vs. Number of Genes

Q: Is there a dependence on the size of the gene tree, i.e., the number of species and genes? ?

Short description of the task at hand.

```{r computeGeneSumDF, echo=FALSE, message=FALSE, results='asis'}
# generate a summary dataframe which holds the data
sumDfGenes <- data.frame(Group = as.character(),
                    Duplication_Rate = as.numeric(),
                    Loss_Rate = as.numeric(),
                    HGT_Rate = as.numeric(),
                    Slope = as.numeric(),
                    Intercept = as.numeric(),
                    Spearman_Corr = as.numeric())
for (i in 1:length(levels(treeDataDf$Group))) {
  sumDfGenes[i,1] <- 0  
}


for (group in 1:length(levels(treeDataDf$Group))) {
  mod = lm(treeDataDf$Fraction_of_Xenologs[which(treeDataDf$Group == levels(treeDataDf$Group)[group])] ~ 
             treeDataDf$Number_of_leaves_tgt[which(treeDataDf$Group == levels(treeDataDf$Group)[group])])
  
  coef <- cor(x = treeDataDf$Number_of_leaves_tgt[which(treeDataDf$Group == levels(treeDataDf$Group)[group])],
              y = treeDataDf$Fraction_of_Xenologs[which(treeDataDf$Group == levels(treeDataDf$Group)[group])], method = 'spearman') 
  
  ### Save to sumDF ###
  sumDfGenes$Group[group] <- levels(treeDataDf$Group)[group]
  sumDfGenes$Duplication_Rate[group] <- treeDataDf$dupl_rate[group*1000-1]
  sumDfGenes$Loss_Rate[group] <- treeDataDf$loss_rate[group*1000-1]
  sumDfGenes$HGT_Rate[group] <- treeDataDf$hgt_rate[group*1000-1]
  sumDfGenes$Slope[group] <-  round(mod[[1]][2], digits = 4)
  sumDfGenes$Intercept[group] <- round(mod[[1]][1], digits = 2)
  sumDfGenes$Spearman_Corr[group] <- round(coef, digits = 2)
}

sumDfGenes %>%
  kbl(caption = "Tab. 1: Dependecy of the size of the gene tree in respect to th number of species. Results of for each Group, slope und intercept of a linear model were calculated as well as the spearman correlation value.") %>%
  kable_classic_2("hover", full_width = F)
```

### 2.1a Plots: Fraction of Xenelogs vs. Number of Genes

Each plot needs a short discription. This can be done here. Maybe it is better not to ```iterate``` over the goups. maybe we should split the following coe into $7$ seperate sektions, so we can write a custom text for each. But I guess an overall discription is fine as well... less work ;)

```{r plotGenes, echo=FALSE, message=FALSE, warning=FALSE}
for (group in 1:length(levels(treeDataDf$Group))) {
  ### Plots ###
  plot <- ggplot(subset(treeDataDf, Group == levels(treeDataDf$Group)[group]), aes(x = Number_of_leaves_tgt,
                                                                                   y = Fraction_of_Xenologs)) +
    geom_point(color = '#30303080') +
    labs(title = paste(levels(treeDataDf$Group)[group], 'Fraction of Xenelogs:', '[',
                       'D:',
                       treeDataDf$dupl_rate[group*1000-1],
                       'L:',
                       treeDataDf$loss_rate[group*1000-1],
                       'H:',
                       treeDataDf$hgt_rate[group*1000-1], ']',
                       sep = ' '), 
         x ='Number of Genes', 
         y = 'Fraction of Xenologs') +
    ylim(0,1) +
    geom_smooth(method='lm', colour = "red", size = 0.5) +
    theme_bw()
  print(plot)
}
```

Some text here. .  .

## 2.1a Fraction of Xenologs vs. Number of Species

Each plot needs a short discription. This can be done here. Maybe it is better not to ```iterate``` over the groups. Maybe we should split the following code into $7$ seperate sektions, so we can write a custom text for each. 

```{r computeSpeciesSumDF, echo=FALSE, message=FALSE, warning=FALSE}
sumDfSpecies <- data.frame(Group = as.character(),
                    Duplication_Rate = as.numeric(),
                    Loss_Rate = as.numeric(),
                    HGT_Rate = as.numeric(),
                    Slope = as.numeric(),
                    Intercept = as.numeric(),
                    Spearman_Corr = as.numeric())
for (i in 1:length(levels(treeDataDf$Group))) {
  sumDfSpecies[i,1] <- 0  
}

for (group in 1:length(levels(treeDataDf$Group))) {
  mod = lm(treeDataDf$Fraction_of_Xenologs[which(treeDataDf$Group == levels(treeDataDf$Group)[group])] ~ 
             treeDataDf$Number_of_Species[which(treeDataDf$Group == levels(treeDataDf$Group)[group])])
  
  coef <- cor(x = treeDataDf$Number_of_Species[which(treeDataDf$Group == levels(treeDataDf$Group)[group])],
              y = treeDataDf$Fraction_of_Xenologs[which(treeDataDf$Group == levels(treeDataDf$Group)[group])], method = 'spearman') 
  ### Save to sumDF ###
  
  sumDfSpecies$Group[group] <- levels(treeDataDf$Group)[group]
  sumDfSpecies$Duplication_Rate[group] <- treeDataDf$dupl_rate[group*1000-1]
  sumDfSpecies$Loss_Rate[group] <- treeDataDf$loss_rate[group*1000-1]
  sumDfSpecies$HGT_Rate[group] <- treeDataDf$hgt_rate[group*1000-1]
  sumDfSpecies$Slope[group] <-  round(mod[[1]][2], digits = 4)
  sumDfSpecies$Intercept[group] <- round(mod[[1]][1], digits = 2)
  sumDfSpecies$Spearman_Corr[group] <- round(coef, digits = 2)
  
}

sumDfSpecies %>%
  kbl(caption = "Tab. 2: Dependecy of the size of the gene tree in respect to th number of species. Results of for each Group, slope und intercept of a linear model were calculated as well as the spearman correlation value.") %>%
  kable_classic_2("hover", full_width = F)

```

### 2.1a Plots: Fraction of Xenelogs vs. Number of Species

Each plot needs a short discription. This can be done here. Maybe it is better not to ```iterate``` over the groups. Maybe we should split the following code into $7$ seperate sections, so we can write a custom text for each. But I guess an overall discription is fine as well... less work ;)

```{r plotSpecies, echo=FALSE, message=FALSE, warning=FALSE}
for (group in 1:length(levels(treeDataDf$Group))) {
  ### Plots ###
  plot <- ggplot(subset(treeDataDf, Group == levels(treeDataDf$Group)[group]), aes(x = Number_of_Species,
                                                                                   y = Fraction_of_Xenologs)) +
    geom_point(color = '#30303080') +
    labs(title = paste(levels(treeDataDf$Group)[group], 'Fraction of Xenelogs:', '[',
                       'D:',
                       treeDataDf$dupl_rate[group*1000-1],
                       'L:',
                       treeDataDf$loss_rate[group*1000-1],
                       'H:',
                       treeDataDf$hgt_rate[group*1000-1], ']',
                       sep = ' '), 
         x = 'Number of Species', 
         y = 'Fraction of Xenologs') +
    ylim(0,1) +
    geom_smooth(method='lm', colour = "red", size = 0.5) +
    theme_bw()
  print(plot)
}
```

Some text here. .  .

## 2.1b Fraction of Xenelogs with fixed HGT

How does the fraction depend on the rate of duplications and losses for a fixed horizontal transfer rate?

Some text was was done here. And maybe why?

### Plot: Duplication Rate

Short introduction

```{r boxplotDupl, echo=FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Boxplot of the Fraction of Xenologs plotted against the duplication rate with a fixed horizontal gene transfer (HGT) rate. The different colors marking the groups with the same HGT rate."

box_hgt_dupl <- ggplot(treeDataDf, aes(x = factor(dupl_rate), 
                                       y = Fraction_of_Xenologs, 
                                       group=factor(hgt_rate))) +
  geom_jitter(shape=16, 
              position=position_jitter(0.15), 
              aes(color = factor(hgt_rate), group=factor(hgt_rate))) +
  geom_boxplot(outlier.shape = NA, 
               show.legend = FALSE, 
               aes(alpha = 0.8, group=factor(dupl_rate))) + 
  labs(title = 'Fraction of Xenologs vs. Duplication Rate', 
       x = 'Duplication Rate', 
       y = 'Fraction of Xenelogs', 
       colour = 'HGT Rate') +
  theme_bw()
box_hgt_dupl
```

In XX we see examples of plotting in R.
Explanation of the graph

### Plot: Loss Rate

Short introduction

```{r boxplotLoss , echo=FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Boxplot of the Fraction of Xenologs plotted against the loss rate with a fixed horizontal gene transfer (HGT) rate. The different colors marking the groups with the same HGT rate."

box_hgt_loss <- ggplot(treeDataDf, aes(x = as.factor(loss_rate), 
                                       y = Fraction_of_Xenologs, 
                                       group=as.factor(hgt_rate))) +
  geom_jitter(shape=16, 
              position=position_jitter(0.15), 
              aes(color = factor(hgt_rate), group=factor(hgt_rate))) +
  geom_boxplot(outlier.shape = NA, 
               show.legend = FALSE, 
               aes(alpha = 0.8, group=factor(dupl_rate))) + 
  labs(title = 'Fraction_of_Xenologs vs. Loss Rate', 
       x = 'Loss Rate', 
       y = 'Fraction of Xenelogs', 
       colour = 'HGT Rate') +
  theme_bw()
box_hgt_loss
```

In XX we see examples of plotting in R.
Explanation of the graph

## 2.1c


How does the fraction depend on the horizontal transfer rate on the the rate of duplications and losses?

How does the fraction depend on the horizontal transfer rate with a fixed duplication and loss rate? --> fixed Question??

### 2.1c Plots Fraction vs. HGT fixes Loss

DIE PLOTS SIND NICHT ZUFRIEDENSTELLEND. PAUL HAST DU EINE TOLLE IDEE WIE WIR DAS GUT DARSTELLEN KÖNNEN

Ab Zeile $205-258$ im ```tree_analyze.R```Script falls da jmd rumexperimentieren mag. Überschrift "**To-Do**"

```{r boxFractionVsHGTDupl, echo=FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
test <- ggplot(treeDataDf, aes(x = as.factor(hgt_rate), 
                               y = Fraction_of_Xenologs, 
                               group=as.factor(dupl_rate))) +
  geom_jitter(shape=16, 
              position=position_jitter(0.15), 
              aes(color = factor(hgt_rate), group=factor(dupl_rate))) +
  geom_boxplot(outlier.shape = NA, 
               show.legend = FALSE, 
               aes(alpha = 0.8, group=factor(dupl_rate))) + 
  labs(title = 'Fraction of Xenologs vs. HGT Rate', 
       x = 'HGT Rate', 
       y = 'Fraction of Xenelogs', 
       colour = 'Duplikation Rate') +
  theme_bw()
test
```

### 2.1c Plots Fraction vs. HGT fixed Duplikation

DIE PLOTS SIND NICHT ZUFRIEDENSTELLEND. PAUL HAST DU EINE TOLLE IDEE WIE WIR DAS GUT DARSTELLEN KÖNNEN

```{r boxFractionVsHGTloss, echo=FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
test1 <- ggplot(treeDataDf, aes(x = as.factor(hgt_rate), 
                               y = Fraction_of_Xenologs, 
                               group=as.factor(loss_rate))) +
  geom_jitter(shape=16, 
              position=position_jitter(0.15), 
              aes(color = factor(hgt_rate), group=factor(loss_rate))) +
  geom_boxplot(outlier.shape = NA, 
               show.legend = FALSE, 
               aes(alpha = 0.8, group=factor(dupl_rate))) + 
  labs(title = 'Fraction of Xenologs vs. HGT Rate', 
       x = 'HGT Rate', 
       y = 'Fraction of Xenelogs', 
       colour = 'Loss Rate') +
  theme_bw()
test1
```

## 2.1d

How does the fraction depend on the frequency of multifurctions.

### 2.1d Plot

AUCH HIER GEFÄLLT MIR DER PLOTT ÜBERHAUPT NICHT. BOXPLOT ÜBER ALLE GRUPPEN? ODER 6 EINZELNE PLOTS FÜR JEDE GRUPPE MIT LINEAREM ODER x^2 MODEL?
ODER WIR BILDEN "BUCKETS" MIT x=NON_BINARY_PROB VS y=FRACTION_OF_XENOLOGS. und wir bilden buckets mit 1 = [0-0.1], 2 = [0.1-0.2], 3 = [0.2-0.3] usw..

```{r plotMultifurcationFraction, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Wasn hier zu sehen??"

plot(x = treeDataDf$non_binary_prob,
     y = treeDataDf$Fraction_of_Xenologs)
```

## 2.2 Fitch from LDT with CD

Second we consider the dependencies for the edges in Fitch graphs computed from an LDT graph. Here the following variants should be considered:

* Complete multipartite graph obtained by solving the Cluster Deletion Problem for the complement of the LDT (see webpage).
* The $rs-Fitch$ graph of the scenario computed with “*Algorithm 1*” from Rbelow.pdf (the latter is already implemented in ```AsymmeTree```).@

@Paul, hast du hier nicht schonmal was angefangen?

In meinem Script finde ich dazu nichts.

### Plots

Die können hier eingefügt werden




## 3. Triples: Characterization of LDT Graph

The triple set $T (G)$ is related to the gene tree, while the triple set $S(G, σ)$ is related to the species tree. It is therefore of interest to compare to what extent $T (G)$ and $S(G, σ)$ overlap the triple sets of true gene tree and the triple set of the true species tree, respectively. **How can this be quantified in a meaningful way?** Again we are interested in the dependence of the simulation parameters.

```{r loadsumCDrecallDf, echo=FALSE, message=FALSE, results='asis'}
#load data Table

sumCDrecallDf <- read.csv(paste(pathScript, 'Summary_CD_Recall.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)
sumCDrecallDf <- subset(sumCDrecallDf, select = -1)


sumCDrecallDf %>%
  kbl(caption = "Tab. 3: Some Caption", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```


```{r loadsumCDprecisionlDf, echo=FALSE, message=FALSE, results='asis'}
#load data Table

sumCDprecisionlDf <- read.csv(paste(pathScript, 'Summary_CD_Precision.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)
sumCDprecisionlDf <- subset(sumCDprecisionlDf, select = -1)

sumCDprecisionlDf %>%
  kbl(caption = "Tab. 4: Some Caption", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```


```{r loadsumCDaccuracyDf, echo=FALSE, message=FALSE, results='asis'}
#load data Table

sumCDaccuracyDf <- read.csv(paste(pathScript, 'Summary_CD_Accuracy.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)
sumCDaccuracyDf <- subset(sumCDaccuracyDf, select = -1)

sumCDaccuracyDf %>%
  kbl(caption = "Tab. 5: Some Caption", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```


```{r loadsumRSrecallDf, echo=FALSE, message=FALSE, results='asis'}
#load data Table

sumRSrecallDf <- read.csv(paste(pathScript, 'Summary_Fitch_Recall.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)
sumRSrecallDf <- subset(sumRSrecallDf, select = -1)

sumRSrecallDf %>%
  kbl(caption = "Tab. 6: Some Caption", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```


```{r loadsumRSprecisionlDf, echo=FALSE, message=FALSE, results='asis'}
#load data Table

sumRSprecisionlDf <- read.csv(paste(pathScript, 'Summary_Fitch_Precision.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)
sumRSprecisionlDf <- subset(sumRSprecisionlDf, select = -1)

sumRSprecisionlDf %>%
  kbl(caption = "Tab. 6: Some Caption", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```


```{r loadsumRSaccuracyDf, echo=FALSE, message=FALSE}
#load data Table

sumRSaccuracyDf <- read.csv(paste(pathScript, 'Summary_Fitch_Accuracy.csv', sep = '/'), sep = ',', dec = ".", header = TRUE, stringsAsFactors = F)
sumRSaccuracyDf <- subset(sumRSaccuracyDf, select = -1)

sumRSaccuracyDf %>%
  kbl(caption = "Tab. 6: Some Caption", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```


```{r fromWideToLong, echo=FALSE, message=FALSE}
#### Correct stuff ####
PsumCDrecallDf <- pivot_longer(sumCDrecallDf, cols = -c("Group"), names_to = "Measure")

ren <- c(100,80,60,40,20,
         100,80,60,40,20,
         100,80,60,40,20,
         100,80,60,40,20,
         100,80,60,40,20,
         100,80,60,40,20,
         100,80,60,40,20)

PsumCDrecallDf$Measure <- ren
PsumCDprecisionlDf <- pivot_longer(sumCDprecisionlDf, cols = -c("Group"), names_to = "Measure")
PsumCDprecisionlDf$Measure <- ren
PsumCDaccuracyDf <- pivot_longer(sumCDaccuracyDf, cols = -c("Group"), names_to = "Measure")
PsumCDaccuracyDf$Measure <- ren
PsumRSrecallDf <- pivot_longer(sumRSrecallDf, cols = -c("Group"), names_to = "Measure")
PsumRSrecallDf$Measure <- ren
PsumRSprecisionlDf <- pivot_longer(sumRSprecisionlDf, cols = -c("Group"), names_to = "Measure")
PsumRSprecisionlDf$Measure <- ren
PsumRSaccuracyDf <- pivot_longer(sumRSaccuracyDf, cols = -c("Group"), names_to = "Measure")
PsumRSaccuracyDf$Measure <- ren

```


### Plots CD

```{r plotCDRecall, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Sinvolle beschreibung des Plottes hier"

recall_CD_Plot <- ggplot(PsumCDrecallDf, aes(x = as.numeric(Measure),
                                             y = value, 
                                             group = as.factor(Group))) +
  labs(title = 'Cluster Deletion: Mean Recall of Groups', 
       x ='Percentage of Original Graph', 
       y = 'Recall', 
       colour = 'Group') +
  geom_line(aes(color = factor(Group))) +
  geom_point(aes(color = factor(Group))) +
  theme_bw()
recall_CD_Plot
```

```{r plotCDacc, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Sinvolle beschreibung des Plottes hier"

acc_CD_Plot <- ggplot(PsumCDaccuracyDf, aes(x = as.numeric(Measure),
                                            y = value, 
                                            group = as.factor(Group))) +
  labs(title = 'Cluster Deletion: Mean Accuracy of Groups', 
       x ='Percentage of Original Graph', 
       y = 'Accuracy', 
       colour = 'Group') +
  geom_line(aes(color = factor(Group))) +
  geom_point(aes(color = factor(Group))) +
  theme_bw()
acc_CD_Plot
```

```{r plotCDprec, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Sinvolle beschreibung des Plottes hier"

prec_CD_Plot <- ggplot(PsumCDprecisionlDf, aes(x = as.numeric(Measure),
                                               y = value, 
                                               group = as.factor(Group))) +
  labs(title = 'Cluster Deletion: Mean Precision of Groups', 
       x ='Percentage of Original Graph', 
       y = 'Precision', 
       colour = 'Group') +
  geom_line(aes(color = factor(Group))) +
  geom_point(aes(color = factor(Group))) +
  theme_bw()
prec_CD_Plot
```

### Plots Fitch (RS)

```{r plotRSrecall, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Sinvolle beschreibung des Plottes hier"

recall_RS_Plot <- ggplot(PsumRSrecallDf, aes(x = as.numeric(Measure),
                                             y = value, 
                                             group = as.factor(Group))) +
  labs(title = 'RS Fitch: Mean Recall of Groups', 
       x ='Percentage of Original Graph', 
       y = 'Recall', 
       colour = 'Group') +
  geom_line(aes(color = factor(Group))) +
  geom_point(aes(color = factor(Group))) +
  theme_bw()
recall_RS_Plot
```

```{r plotRSacc, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Sinvolle beschreibung des Plottes hier"

acc_RS_Plot <- ggplot(PsumRSaccuracyDf, aes(x = as.numeric(Measure),
                                            y = value, 
                                            group = as.factor(Group))) +
  labs(title = 'RS Fitch: Mean Accuracy of Groups', 
       x ='Percentage of Original Graph', 
       y = 'Accuracy', 
       colour = 'Group') +
  geom_line(aes(color = factor(Group))) +
  geom_point(aes(color = factor(Group))) +
  theme_bw()
acc_RS_Plot
```

```{r plotRSprec, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Sinvolle Beschreibung des Plottes hier"

prec_RS_Plot <- ggplot(PsumRSprecisionlDf, aes(x = as.numeric(Measure),
                                               y = value, 
                                               group = as.factor(Group))) +
  labs(title = 'RS Fitch: Mean Precision of Groups', 
       x ='Percentage of Original Graph', 
       y = 'Precision', 
       colour = 'Group') +
  geom_line(aes(color = factor(Group))) +
  geom_point(aes(color = factor(Group))) +
  theme_bw()
prec_RS_Plot
```

## Tripple T Plots

Hier stimmt was mit den Daten nicht so ganz. Über all $1$ drin. 

### Recall

```{r recall_T_LDTx, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Beschreibender Text hier."

recall_T_LDT <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                       y = T_LDT_recall, 
                                       group = as.factor(Group))) +
  labs(title = 'Triple T: Mean Recall of Groups', 
       x ='Group', 
       y = 'Recall', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  #ylim(0,0.25) +
  stat_summary(fun.y=mean, geom="point", shape=23, size=3) +
  theme_bw()
recall_T_LDT
```

Summary Table Recall

```{r sumOfTrippleRecall, echo=FALSE, message=FALSE}
gruppen <- levels(treeDataDf$Group)
sumTripple <- data.frame(Group = character(length(gruppen)))
for (i in 1:length(gruppen)) {
  sumTripple$Group[i] <- gruppen[i]
  sumTripple$T_LDT_Recall_Mean[i] <- round(mean(treeDataDf$T_LDT_recall[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumTripple$T_LDT_Recall_Median[i] <- round(median(treeDataDf$T_LDT_recall[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumTripple$S_LDT_Recall_Mean[i] <- round(mean(treeDataDf$S_LDT_recall[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumTripple$S_LDT_Recall_Median[i] <- round(median(treeDataDf$S_LDT_recall[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
}

sumTripple %>%
  kbl(caption = "Tab. 6: Recall", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```

### Precision

```{r precision_Tr_LDTx, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Beschreibender Text hier."

precision_T_LDT <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                       y = T_LDT_precision, 
                                       group = as.factor(Group))) +
  labs(title = 'Triple Gene Tree: Mean Precision of Groups', 
       x ='Group', 
       y = 'Precision', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  #ylim(0,0.25) +
  stat_summary(fun.y=mean, geom="point", shape=23, size=3) +
  theme_bw()
precision_T_LDT
```

Precision Summary

```{r sumOfTripplePrecision, echo=FALSE, message=FALSE}
sumPrecision <- data.frame(Group = character(length(gruppen)))
for (i in 1:length(gruppen)) {
  sumPrecision$Group[i] <- gruppen[i]
  sumPrecision$T_LDT_Precision_Mean[i] <- round(mean(treeDataDf$T_LDT_precision[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumPrecision$T_LDT_Precision_Median[i] <- round(median(treeDataDf$T_LDT_precision[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumPrecision$S_LDT_Precision_Mean[i] <- round(mean(treeDataDf$S_LDT_precision[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumPrecision$S_LDT_Precision_Median[i] <- round(median(treeDataDf$S_LDT_precision[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
}

sumPrecision %>%
  kbl(caption = "Tab. 6: Precision", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```

### Accuracy Plot

```{r accuracy_Tr_LDT, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Accuracy Beschreibender Text hier."

accuracy_T_LDT <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                          y = T_LDT_accuracy, 
                                          group = as.factor(Group))) +
  labs(title = 'Triple T: Mean Precision of Groups', 
       x ='Group', 
       y = 'Accuracy', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  ylim(0,0.002) +
  stat_summary(fun.y=mean, geom="point", shape=23, size=3) +
  theme_bw()
accuracy_T_LDT
```

Accuracy Summary

```{r sumOfTrippleAccuracy, echo=FALSE, message=FALSE}
sumAccuracy <- data.frame(Group = character(length(gruppen)))
for (i in 1:length(gruppen)) {
  sumAccuracy$Group[i] <- gruppen[i]
  sumAccuracy$T_LDT_Accuracy_Mean[i] <- round(mean(treeDataDf$T_LDT_accuracy[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumAccuracy$T_LDT_Accuracy_Median[i] <- round(median(treeDataDf$T_LDT_accuracy[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumAccuracy$S_LDT_Accuracy_Mean[i] <- round(mean(treeDataDf$S_LDT_accuracy[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
  sumAccuracy$S_LDT_Accuracy_Median[i] <- round(median(treeDataDf$S_LDT_accuracy[which(treeDataDf$Group == gruppen[i])], na.rm = T), digits = 4)
}

sumPrecision %>%
  kbl(caption = "Tab. 6: Precision", digits = 2) %>%
  kable_classic_2("hover", full_width = F)
```

## Tripple S

### Recall

```{r Recall_Tr_S_LDT, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Recall: Beschreibender Text hier."

recall_S_LDT <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                       y = S_LDT_recall, 
                                       group = as.factor(Group))) +
  labs(title = 'Triple S: Mean Recall of Groups', 
       x ='Group', 
       y = 'Recall', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  ylim(0.99,1.1) +
  stat_summary(fun.y=mean, geom="point", shape=23, size=3) +
  theme_bw()
recall_S_LDT
```

### Precision

```{r Precision_Tr_S_LDT, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Precision: Beschreibender Text hier."

precision_S_LDT <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                          y = S_LDT_precision, 
                                          group = as.factor(Group))) +
  labs(title = 'Triple S: Mean Precision of Groups', 
       x ='Group', 
       y = 'Precision', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  ylim(0,0.01) +
  stat_summary(fun.y=mean, geom="point", shape=23, size=3) +
  theme_bw()
precision_S_LDT
```

### Accuracy

```{r Accuracy_Tr_S_LDT, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Accuracy: Beschreibender Text hier."

accuracy_S_LDT <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                         y = S_LDT_accuracy, 
                                         group = as.factor(Group))) +
  labs(title = 'Triple S: Mean Accuracy of Groups', 
       x ='Group', 
       y = 'Accuracy', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  ylim(-0.1,1) +
  stat_summary(fun.y=mean, geom="point", shape=23, size=3) +
  theme_bw()
accuracy_S_LDT
```


### Tripple T Fraction

```{r Tripple_T_Fraction, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Tripple T Fraction: Beschreibender Text hier."

T_Triple_Fraction <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                         y = T_Triple_Fraction, 
                                         group = as.factor(Group))) +
  labs(title = 'Triple T: Fraction of Triples within the LDT Graph', 
       x ='Group', 
       y = 'Fraction of Triples in LDT-Graph', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  ylim(0,0.70) +
  stat_summary(fun=mean, geom="point", shape=23, size=3) +
  theme_bw()
T_Triple_Fraction
```

### Tripple S Fraction

```{r Tripple_S_Fraction, echo = FALSE, message=FALSE, warning=FALSE, fig.cap=caption}
caption = "Tripple S Fraction: Beschreibender Text hier."

S_Triple_Fraction <- ggplot(treeDataDf, aes(x = as.factor(Group),
                                            y = S_Triple_Fraction, 
                                            group = as.factor(Group))) +
  labs(title = 'Triple S: Fraction of Triples within the LDT Graph', 
       x ='Group', 
       y = 'Fraction of Triples in LDT-Graph', 
       colour = 'Group') +
  geom_boxplot(aes(color = factor(Group)), outlier.shape = NA, show.legend = FALSE) +
  ylim(0,0.70) +
  stat_summary(fun=mean, geom="point", shape=23, size=3) +
  theme_bw()
S_Triple_Fraction
```